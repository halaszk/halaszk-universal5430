ui_print(" ");
ui_print("Installing kernel...");
ui_print(" ");
ui_print("Mounting System");
mount("ext4", "EMMC", "/dev/block/mmcblk0p18", "/system");
ui_print(" ");
ui_print("Removing Knox...");
delete("/system/app/Bridge.apk", "/system/app/Bridge.odex");
delete("/system/app/KNOXAgent.apk", "/system/app/KNOXAgent.odex");
delete("/system/app/KNOXStore.apk", "/system/app/KNOXStore.odex");
delete("/system/app/KNOXStub.apk", "/system/app/KNOXStub.odex");
delete("/system/app/KnoxAttestationAgent.apk", "/system/app/KnoxAttestationAgent.odex");
delete("/system/app/KnoxSetupWizardClient.apk", "/system/app/KnoxSetupWizardClient.odex");
delete("/system/app/ContainerEventsRelayManager.apk", "/system/app/ContainerEventsRelayManager.odex");
delete("/system/app/ContainerAgent.apk", "/system/app/ContainerAgent.odex");
delete_recursive("/system/container");
delete_recursive("/system/etc/secure_storage/com.sec.knox.seandroid");
delete("/system/priv-app/KLMSAgent.apk", "/system/priv-app/KLMSAgent.odex");
delete("/system/priv-app/SPDClient.apk", "/system/priv-app/SPDClient.odex");
delete("/system/tima_measurement_info");
ui_print(" ");
ui_print("Deleting Old Modules");
delete("/system/lib/modules");
ui_print(" ");
ui_print("Writing boot.img");
package_extract_file("boot/boot.img", "/dev/block/mmcblk0p9");
package_extract_dir("system", "/system");
set_perm(0, 0, 0755, "/system/xbin/ntfs-3g");
set_perm_recursive(0, 2000, 0755, 0755, "/system/etc/init.d");
ui_print(" ");
ui_print("Unmounting");
unmount("/system");
ui_print(" ");
ui_print(".. Done!");
ui_print(" ");
